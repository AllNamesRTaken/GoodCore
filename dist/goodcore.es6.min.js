function sign(t){return"number"==typeof t?t?t<0?-1:1:t==t?0:NaN:NaN}function rotationDeg(t){let e=t*CalcConst.ROTATION_DEGREE_PRECISION|0;for(;e<0;)e+=CalcConst.DEG360;for(;e>=CalcConst.DEG360;)e-=CalcConst.DEG360;return CalcConst.ROTATION_LOOKUP[e]}function rotationRad(t){const e=t*CalcConst.DEGREE_FACTOR*CalcConst.ROTATION_DEGREE_PRECISION|0;return this.rotationDeg(e/CalcConst.ROTATION_DEGREE_PRECISION)}function closestRadianRotation(t){let e=t*CalcConst.DEGREE_FACTOR*CalcConst.ROTATION_DEGREE_PRECISION|0;for(;e<0;)e+=CalcConst.DEG360;for(;e>=CalcConst.DEG360;)e-=CalcConst.DEG360;return e*CalcConst.RADIAN_FACTOR/CalcConst.ROTATION_DEGREE_PRECISION}function hasWindow(){return null!==Global.window}function hasConsole(){return this.hasWindow()&&void 0!==Global.window.console||"function"==typeof console}function isArray(t){return!(!t||!(t instanceof Array||"array"==typeof t))}function isElement(t){return void 0!==t&&null!==t&&1===t.nodeType}function isFunction(t){return"[object Function]"===Object.prototype.toString.call(t)}function isNumber$1(t){return t===+t}function isInt(t){return isNumber$1(t)&&t===(0|t)}function isString(t){return isNotNullOrUndefined(t)&&t.constructor===String}function areNullOrUndefined(...t){const e=t.length;let n,i=-1,s=!1;for(;!s&&++i<e;)s=void 0===(n=t[i])||null===n;return s}function areNotNullOrUndefined(...t){return!areNullOrUndefined(...t)}function isNullOrUndefined(t){return void 0===t||null===t}function isNotNullOrUndefined(t){return!isNullOrUndefined(t)}function areUndefined(...t){const e=t.length;let n,i=-1,s=!1;for(;!s&&++i<e;)s=void 0===(n=t[i]);return s}function areNotUndefined(...t){return!areUndefined(...t)}function isUndefined$1(t){return void 0===t}function isNotUndefined(t){return!isUndefined$1(t)}function destroy(t){void 0!==t.constructor.prototype.destroy?t.destroy():setNull(t)}function wipe(t){const e=Object.keys(t);let n=-1;const i=e.length;for(;++n<i;)delete t[e[n]]}function setNull(t){if(void 0!==t.constructor.prototype.clear)t.clear();else{const e=Object.keys(t);let n=null,i=-1;const s=e.length;for(;++i<s;)t[n=e[i]]=null}}function isClassOf(t,e){return areNotNullOrUndefined(t,e)&&t instanceof e.constructor}function isSameClass(t,e){return areNotNullOrUndefined(t,e)&&t.constructor===e.constructor}function inherits(t,e){return isClassOf(t,e)&&!isSameClass(t,e)}function equals(t,e){let n=t===e;if(t!==e&&t instanceof Object&&isSameClass(t,e))if(isArray(t)){const i=t.length;let s=0;if(n=i===e.length)for(;s<i&&!1!==(n=equals(t[s],e[s]));s+=1);}else if(t.constructor.prototype.equals)n=t.equals(e);else{const i=Object.keys(t);let s=null;n=!0;let r=-1;const o=i.length;for(;++r<o;)if(s=i[r],!(n=equals(t[s],e[s]))){if(!isFunction(t[s]))break;n=!0}}return n}function isDifferent(t,e){return!equals(t,e)}function shallowCopy$1(t){const e=Object.keys(t),n={};let i=-1;const s=e.length;for(;++i<s;){const s=e[i];n[s]=t[s]}return n}function clone(t){let e;if(t instanceof Object)if(void 0!==t.constructor.prototype.clone)e=t.clone();else if(isArray(t))e=deepCopy(t);else{if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t);{e=new t.constructor;const n=Object.keys(t);let i=null,s=-1;const r=n.length;for(;++s<r;)e[i=n[s]]=clone(t[i])}}else e=t;return e}function cloneInto(t,e){if(isArray(e)){const n=t,i=e,s=n.length;i.length=s;let r=-1;for(;++r<s;)n[r]instanceof Object?cloneInto(n[r],i[r]):i[r]=n[r]}else{const n=Object.keys(t);let i=null,s=-1;const r=n.length;for(;++s<r;){const r=t[i=n[s]];if(r instanceof Object){let t=e[i];void 0!==t&&null!==t||(t=isArray(r)?e[i]=[]:e[i]={}),isDifferent(r,t)&&cloneInto(r,t)}else e[i]=r}}return e}function mixin(t={},e,...n){const i=t,s=n?n.length:0;let r=0;for(n=flatten(n);r<s;r++){let i=n[r];if(isFunction(i)&&(i=i.prototype),void 0===i)continue;const s=Object.keys(i);let o=null;if(e){let n=-1;const r=s.length;for(;++n<r;)o=s[n],e.hasOwnProperty(o)||(t[o]=i[o])}else{let e=-1;const n=s.length;for(;++e<n;)t[o=s[e]]=i[o]}}return i}function setProperties(t,e,n){const i=Object.keys(e);let s,r,o=-1;const l=i.length;for(;++o<l;)r=e[s=i[o]],n&&s in n&&(s=n[s]),s in t&&(t[s]=e[i[o]])}function flatten(t){return flattenInner(t)}function flattenInner(t,e=[]){let n=-1;const i=t.length;for(;++n<i;)isArray(t[n])?flattenInner(t[n],e):e.push(t[n]);return e}function reverse(t){let e=null,n=null;const i=t.length;for(e=0;e<i/2;e+=1){n=i-1-e;const s=t[e];t[e]=t[n],t[n]=s}return t}function concat(...t){return Array.prototype.concat.apply([],t)}function slice(t,e=0,n=1/0){let i=Math.min(t.length-e,n);i<0&&(i=0);let s=-1;const r=new Array(i);for(;++s<i;)r[s]=t[s+e];return r}function append(t,e){let n=-1;const i=t.length,s=e.length;for(;++n<s;)t[i+n]=e[n]}function removeAt(t,e){let n;if(-1!==e&&e<t.length){const i=t.length;let s=e;for(n=t[e];++s<i;)t[s-1]=t[s];t.length-=1}return n}function indexOfElement(t,e){let n=-1;const i=t.length;for(;++n<i;)if(t[n]===e)return n;return-1}function remove(t,e){removeAt(t,indexOfElement(t,e))}function indexOf(t,e){let n=-1;const i=t.length;for(;++n<i;)if(e(t[n]))return n;return-1}function removeOneByFn(t,e){removeAt(t,indexOf(t,e))}function shallowCopy(t){let e=-1;const n=t.length,i=new Array(n);for(;++e<n;)i[e]=t[e];return i}function shallowCopyInto(t,e){let n=-1;const i=t.length;for(e.length=i;++n<i;)e[n]=t[n]}function shallowFill(t,e,n=0){let i=-1;const s=t.length;for(e.length<s+n&&(e.length=s+n);++i<s;)e[n+i]=t[i]}function deepCopy(t){let e=-1;const n=t.length,i=new Array(n);for(;++e<n;)i[e]=clone(t[e]);return i}function deepCopyInto(t,e){let n=-1;const i=t.length;for(e.length=i;++n<i;)e[n]=clone(t[n])}function deepFill(t,e,n=0){let i=-1;const s=t.length;for(e.length<s+n&&(e.length=s+n);++i<s;)e[n+i]=clone(t[i])}function filter(t,e){const n=[];let i=-1;const s=t.length;for(;++i<s;){const s=t[i];!0===e(s,i)&&n.push(s)}return n}function filterInto(t,e,n){let i=-1,s=0;const r=t.length,o=e.length;for(;++i<r;){const r=t[i];!0===n(r,i)&&(s<o?e[s++]=r:(++s,e.push(r)))}e.length=s}function map(t,e){let n=-1;const i=t.length,s=new Array(i);for(;++n<i;)s[n]=e(t[n],n);return s}function mapInto(t,e,n){let i=-1;const s=t.length;for(e.length=s;++i<s;)e[i]=n(t[i],i)}function reduce(t,e,n){let i=-1;const s=t.length;let r=n;for(;++i<s;)r=e(r,t[i]);return r}function reduceUntil(t,e,n,i){let s=-1;const r=t.length;let o=i;for(;++s<r&&!n(o,t[s]);)o=e(o,t[s]);return o}function reverseReduce(t,e,n){let i=t.length,s=n;for(;--i>=0;)s=e(s,t[i]);return s}function reverseReduceUntil(t,e,n,i){let s=t.length,r=i;for(;--s>=0&&!n(r,t[s]);)r=e(r,t[s]);return r}function forEach(t,e,n=0){let i=n-1;const s=t.length;for(;++i<s;)e(t[i],i)}function forSome(t,e,n){let i=-1;const s=t.length;for(;++i<s;){const s=t[i];e(s,i)&&n(s,i)}}function until(t,e,n,i){let s=isUndefined(n)||isNumber(n),r=isUndefined(i=s?n:i)||i<0?-1:i-1;const o=t.length;for(;++r<o&&(s?!e(t[r],r):!(e(t[r],r)||(n(t[r],r),!1))););}function reverseForEach(t,e){let n=t.length;for(;--n>=0;)e(t[n],n)}function reverseUntil(t,e,n){let i=t.length,s=isUndefined(n);for(;--i>=0&&(s?!e(t[i],i):!(e(t[i],i)||(n(t[i],i),!1))););}function some(t,e){let n=!1,i=-1;const s=t.length;for(;++i<s&&!(n=e(t[i])););return n}function all(t,e){let n=!0,i=-1;const s=t.length;for(;++i<s&&(n=e(t[i])););return n}function insertAt(t,e,n){if(0===e)t.unshift(n);else if(e>0){let i=t.length;for(;--i>=e;)t[i+1]=t[i];t[i+1]=n}}function binarySearch(t,e,n=!1){let i,s,r=0,o=t.length-1;for(;r<=o;){let n=e(s=t[i=r+o>>1]);if(n<0)r=i+1;else{if(!(n>0))return i;o=i-1}}return n?r:-1}function create(t,e){t<0&&(t=0);let n=new Array(t),i=-1;for(;++i<t;)n[i]=e(i,n);return n}function init(t){void 0!==t&&(Global.window=t)}function getFunctionName(t){let e;if(void 0!==t.hasOwnProperty("name"))e=t.name;else{const n=t.toString();e=n.substring(9,n.indexOf("("))}return e}function getFunctionCode(t){let e;const n=t.toString();return e=n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))}function newUUID(){let t=(new Date).getTime();return t+=Timer.now(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)})}function newInt(){return UtilState._int++}function callDebugger(){}function pipeOut(t,e,n){if(hasConsole)proxyFn(console,"log",function(e,...n){e(...n),t(...n)}),proxyFn(console,"warn",function(t,...n){t(...n),e(...n)}),proxyFn(console,"error",function(t,...e){t(...e),n(...e)});else{const i={log:t,warn:e,error:n};hasWindow()?Global.window.console=i:Global.window={console:i}}}function assert(t,e,n=!0){let i=!0;return t||(hasConsole&&(i=!1,console.error("Assertion failed: "+e)),n&&callDebugger()),i}function proxyFn(t,e,n){const i=(t=isNotUndefined(t.prototype)?t.prototype:t)[e];t[e]=n.bind(t,function(...e){return 0!==e.length?i.apply(this||t,e):i.call(this||t)})}function loop(t,e){let n=-1;for(;++n<t;)e(n)}function toArray(t){return Array.prototype.slice.call(t)}function init$1(t){Global.window=t,DomState._window=Global.window,DomState._document=DomState._window.document,DomState._el=DomState._document.createElement("div")}function toArray$1(t){return Array.prototype.slice.call(t)}function create$1(t,e){let n;return DomState._el.innerHTML=t,n=DomState._el.children[0],setAttr(n,e),clear(DomState._el),n}function outerHTML(t){DomState._el.appendChild(t);const e=DomState._el.innerHTML;return clear(DomState._el),e}function setAttr(t,e){let n;n="string"==typeof t?get(t):t;let i,s,r,o,l,a;if(void 0!==e&&"object"==typeof e)for(i=Object.keys(e),s=0;s<i.length;s++)if("style"===i[s])for(o=e[i[s]],l=Object.keys(o),r=0;r<l.length;r++)"string"==typeof(a=o[l[r]])?n.style.setProperty(l[r],a):n.style.setProperty(l[r],a[0],a[1]);else"classes"===i[s]&&void 0!==e[i[s]]&&e[i[s]].join?n.setAttribute("className",e[i[s]].join(" ")):n.setAttribute(i[s],e[i[s]])}function remove$1(t){return void 0===t.parentNode?null:t.parentNode.removeChild(t)}function replace(t,e){let n=e;return t.parentNode&&t.parentNode.replaceChild(e,t),n}function clear(t){let e=t.children.length;for(;e--;)t.removeChild(t.children[e])}function get(t){let e=DomState._document.getElementById(t);return null===e&&(e=DomState._document.body),e}function find(t){return DomState._document.querySelector(t)}function findAll(t,e){return toArray$1((e||DomState._document).querySelectorAll(t))}function children(t,e){const n=toArray$1((t||DomState._document).children);return void 0===e?n:n.filter(is.bind(this,e))}function findParent(t,e){let n=t.parentElement;for(;n&&!is(e,n);)n=n.parentElement;return n}function position(t,e,n){t.style.top=n+"px",t.style.left=e+"px"}function is(t,e){let n=!1;if(e.matches)n=e.matches(t);else if(e.msMatchesSelector)n=e.msMatchesSelector(t);else if(e.webkitMatchesSelector)n=e.webkitMatchesSelector(t);else{if(null===e.parentElement)throw new Error("Element has no parent");n=""!==e.id?null!==e.parentElement.querySelector("#"+e.id):-1!==toArray$1(e.parentElement.querySelectorAll(t)).indexOf(e)}return n}function setStylesExplicitly(t,...e){const n=DomState._window.getComputedStyle(t);for(const i of e)t.style[i]=n[i]}function Poolable(t){return class extends t{release(){this.__pool__.release(this)}initPool(t){this.__pool__=t}constructor(...t){super(...t)}}}function Initable(t){return class extends t{init(t,e){return setProperties(this,t,e),this}}}function before(t){return function(e,n,i){const s=i.value;return i.value=function(...e){t.apply(this,[s.name].concat(e));return s.apply(this,e)},i}}function after(t){return function(e,n,i){const s=i.value;return i.value=function(...e){const n=s.apply(this,[s.name].concat(e));return t.apply(this,e),n},i}}function around(t){return function(e,n,i){const s=i.value;return i.value=function(...e){let n;return t.apply(this,[()=>n=s.apply(this,e),s.name].concat(e)),n},i}}function provided(t){return function(e,n,i){const s=i.value;return i.value=function(...e){let n;return t.apply(this,[s.name].concat(e))&&(n=s.apply(this,e)),n},i}}function randomString(t=25){let e="";for(let n=0;n<t;n+=1)e+=VALID_CHARS.charAt(Math.floor(Math.random()*VALID_CHARS.length));return e}function randomInt(){return 0|this.randomNumber()}function randomNumber(){return 2147483647*Math.random()}function numericArray(t,e=MocDataType.LinearInt){const n=new Array(t);switch(e){case MocDataType.RandomInt:for(let e=0;e<t;e+=1)n[e]=this.randomInt();break;case MocDataType.LinearFloat:for(let e=0;e<t;e+=1)n[e]=e+.5;break;case MocDataType.RandomFloat:for(let e=0;e<t;e+=1)n[e]=this.randomNumber();break;default:for(let e=0;e<t;e+=1)n[e]=e}return n}function stringArray(t,e){const n=new Array(t);let i=-1;for(;++i<t;)n[i]=this.randomString(e);return n}function integrate(t){let e=!1,n=[{name:"Arr",object:Arr},{name:"Calc",object:Calc},{name:"Dom",object:Dom},{name:"MocData",object:MocData},{name:"Obj",object:Obj},{name:"Initable",object:Initable},{name:"Poolable",object:Poolable},{name:"Pool",object:Pool},{name:"Dictionary",object:Dictionary},{name:"KeyValuePair",object:KeyValuePair},{name:"List",object:List},{name:"Range2",object:Range2},{name:"Rect",object:Rect},{name:"Stack",object:Stack},{name:"Tree",object:Tree},{name:"Vec2",object:Vec2},{name:"Test",object:Test},{name:"Timer",object:Timer},{name:"Uri",object:Uri},{name:"Util",object:Util}];"string"==typeof t&&(Global.window[t]={},e=!0);for(const i of n)e?Global.window[t][i.name]=i.object:Global.window[i.name]=i.object}import{isNumber,isUndefined}from"util";class CalcConst{}CalcConst.ROTATION_DEGREE_PRECISION=1,CalcConst.RADIAN_FACTOR=1/360*(2*Math.PI),CalcConst.DEGREE_FACTOR=1/(2*Math.PI)*360,CalcConst.DEG360=360*CalcConst.ROTATION_DEGREE_PRECISION,CalcConst.ROTATION_LOOKUP=function(){const t=[];for(let e=0;e<360*CalcConst.ROTATION_DEGREE_PRECISION;e++)t.push([Math.cos(e*CalcConst.RADIAN_FACTOR),Math.sin(e*CalcConst.RADIAN_FACTOR)]);return t}();var Calc=Object.freeze({CalcConst:CalcConst,sign:sign,rotationDeg:rotationDeg,rotationRad:rotationRad,closestRadianRotation:closestRadianRotation});class Vec2Const{}Vec2Const.EPSILON=1e-8,Vec2Const.IDENTITY={x:1,y:1},Vec2Const.X_DIM={x:1,y:0},Vec2Const.Y_DIM={x:0,y:1};class Vec2{constructor(t=0,e=0){this.angle=this.horizontalAngle,this.direction=this.horizontalAngle,this.x=t,this.y=e}get isZero(){return 0===this.x&&0===this.y}set(t){return this.x=t.x,this.y=t.y,this}clone(t){return t?t.set(this):new Vec2(this.x,this.y)}toInt(){return this.x|=0,this.y|=0,this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}toDecimal(){return this.x+=Vec2Const.EPSILON,this.y+=Vec2Const.EPSILON,this}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.lengthSq())}horizontalAngle(){return Math.atan2(this.y,this.x)}rotate(t){const e=rotationRad(t),n=this.x*e[0]-this.y*e[1],i=this.x*e[1]+this.y*e[0];return this.x=n,this.y=i,this}rotateAround(t,e){return this.subtract(t).rotate(e).add(t)}normalize(){const t=this.length();return 0===t?(this.x=1,this.y=0):(this.x=this.x/t,this.y=this.y/t),this}scale(t){return this.x=this.x*t.x,this.y=this.y*t.y,this}relate(t){return this.x=this.x/t.x,this.y=this.y/t.y,this}multiply(t){return this.x=this.x*t,this.y=this.y*t,this}add(t){return this.x=this.x+t.x,this.y=this.y+t.y,this}subtract(t){return this.x=this.x-t.x,this.y=this.y-t.y,this}invert(){return this.x=-this.x,this.y=-this.y,this}equals(t){return this.x===t.x&&this.y===t.y}almostEquals(t){return Math.abs(this.x-t.x)<Vec2Const.EPSILON&&Math.abs(this.y-t.y)<Vec2Const.EPSILON}getNormal(t){const e=this.clone();t||e.set(this).normalize();const n=e.x;return e.x=e.y,e.y=-n,e}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}projectOnto(t){const e=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=e*t.x,this.y=e*t.y,this}verticalAngle(){return Math.atan2(this.x,this.y)}rotateBy(t){const e=-this.horizontalAngle()+t;return this.rotate(e)}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}zero(){return this.x=0,this.y=0,this}}class Rect{get isZero(){return this.start.isZero&&this.stop.isZero}constructor(t=0,e=0,n=0,i=0,s=!1){this.start=new Vec2(t,e),this.stop=new Vec2(n,i),this.endInclusive=s}set(t){return this.start.set(t.start),this.stop.set(t.stop),this}clone(t){return t?t.set(this):new Rect(this.start.x,this.start.y,this.stop.x,this.stop.y)}toRange2(t){let e=t||new Range2,n=this.start,i=this.stop;return e.pos.x=n.x,e.pos.y=n.y,e.size.x=i.x+(this.endInclusive?i.x<n.x?-1:1:0)-n.x,e.size.y=i.y+(this.endInclusive?i.y<n.y?-1:1:0)-n.y,e}scale(t,e=!0){const n=this.stop.x-this.start.x,i=this.stop.y-this.start.y;let s=n,r=i;return s*=t.x,r*=t.y,e&&(this.start.x-=(s-n)/2,this.start.y-=(r-i)/2),this.stop.x=this.start.x+s,this.stop.y=this.start.y+r,this}translate(t){return this.start.scale(t),this.stop.scale(t),this}equals(t){return this.start.equals(t.start)&&this.stop.equals(t.stop)}toInt(){return this.start.toInt(),this.stop.toInt(),this}toDecimal(){return this.start.toDecimal(),this.stop.toDecimal(),this}area(){return(this.stop.x-this.start.x)*(this.stop.y-this.start.y)}move(t){return this.start.add(t),this.stop.add(t),this}contains(t){return this.start.x<=t.start.x&&this.start.y<=t.start.y&&this.stop.x>=t.stop.x&&this.stop.y>=t.stop.y}intersect(t){return this.containsPoint(t.start.x,t.start.y)||this.containsPoint(t.stop.x,t.stop.y)||this.containsPoint(t.start.x,t.stop.y)||this.containsPoint(t.stop.x,t.start.y)}containsPoint(t,e){return this.start.x<=t&&this.stop.x>=t&&this.start.y<=e&&this.stop.y>=e}zero(){return this.start.zero(),this.stop.zero(),this}}class Range2{get isZero(){return this.pos.isZero&&this.size.isZero}constructor(t=0,e=0,n=0,i=0){this.pos=new Vec2(t,e),this.size=new Vec2(n,i)}set(t){return this.pos.set(t.pos),this.size.set(t.size),this}clone(t){return t?t.set(this):new Range2(this.pos.x,this.pos.y,this.size.x,this.size.y)}toRect(t=!1,e){let n=e||new Rect;return n.start.x=this.pos.x,n.start.y=this.pos.y,n.stop.x=this.pos.x-(t?this.size.x<0?-1:1:0)+this.size.x,n.stop.y=this.pos.y-(t?this.size.y<0?-1:1:0)+this.size.y,n.endInclusive=t,n}scale(t,e=!0){let n=null;return e&&(n=this.size.clone()),this.size.scale(t),e&&this.pos.add(n.subtract(this.size).multiply(.5)),this}translate(t){return this.toRect(!1).translate(t).toRange2(this),this}toInt(){return this.pos.toInt(),this.size.toInt(),this}toDecimal(){return this.pos.toDecimal(),this.size.toDecimal(),this}contains(t){return this.pos.x<=t.pos.x&&this.pos.y<=t.pos.y&&this.pos.x+this.size.x>=t.pos.x+t.size.x&&this.pos.y+this.size.y>=t.pos.y+t.size.y}intersect(t){let e=this.toRect(),n=t.clone().toRect();return e.intersect(n)}containsPoint(t){return t.x>=this.pos.x&&t.x<=this.pos.x+this.size.x-1&&t.y>=this.pos.y&&t.y<=this.pos.y+this.size.y-1}first(t){const e=new Vec2,n=this.pos.x,i=this.pos.y;for(let s=0;s<this.size.x;s++)for(let r=0;r<this.size.y;r++)if(e.x=s+n,e.y=r+i,t(e))return e;return null}forEach(t,e=null){const n=new Vec2,i=this.pos.clone().toInt();null!==e&&this.containsPoint(e)||(e=i);const s=this.pos.clone().add(this.size).toInt();for(let r=i.y;r<s.y;r+=1)for(let o=i.x;o<s.x;o+=1){if(r<e.y||r===e.y&&o<e.x)continue;n.x=o,n.y=r;if(t(n))return}}equals(t){return this.pos.equals(t.pos)&&this.size.equals(t.size)}zero(){return this.pos.zero(),this.size.zero(),this}}let nativeWindow=!0;var win;"undefined"==typeof window?(win=null,nativeWindow=!1):win=window;class _Global{constructor(){this._window=win,this._nativeWindow=nativeWindow}get window(){return this._window}set window(t){this._window=t,this.hasNativeWindow&&(win=t)}get hasNativeWindow(){return this._nativeWindow}}let Global=new _Global;var Test=Object.freeze({hasWindow:hasWindow,hasConsole:hasConsole,isArray:isArray,isElement:isElement,isFunction:isFunction,isNumber:isNumber$1,isInt:isInt,isString:isString,areNullOrUndefined:areNullOrUndefined,areNotNullOrUndefined:areNotNullOrUndefined,isNullOrUndefined:isNullOrUndefined,isNotNullOrUndefined:isNotNullOrUndefined,areUndefined:areUndefined,areNotUndefined:areNotUndefined,isUndefined:isUndefined$1,isNotUndefined:isNotUndefined}),Obj=Object.freeze({destroy:destroy,wipe:wipe,setNull:setNull,isClassOf:isClassOf,isSameClass:isSameClass,inherits:inherits,equals:equals,isDifferent:isDifferent,shallowCopy:shallowCopy$1,clone:clone,cloneInto:cloneInto,mixin:mixin,setProperties:setProperties}),Arr=Object.freeze({flatten:flatten,reverse:reverse,concat:concat,slice:slice,append:append,removeAt:removeAt,indexOfElement:indexOfElement,remove:remove,indexOf:indexOf,removeOneByFn:removeOneByFn,shallowCopy:shallowCopy,shallowCopyInto:shallowCopyInto,shallowFill:shallowFill,deepCopy:deepCopy,deepCopyInto:deepCopyInto,deepFill:deepFill,filter:filter,filterInto:filterInto,map:map,mapInto:mapInto,reduce:reduce,reduceUntil:reduceUntil,reverseReduce:reverseReduce,reverseReduceUntil:reverseReduceUntil,forEach:forEach,forSome:forSome,until:until,reverseForEach:reverseForEach,reverseUntil:reverseUntil,some:some,all:all,insertAt:insertAt,binarySearch:binarySearch,create:create});class Dictionary{constructor(){this._lookup=Object.create(null),this._list=new List,this._isDirty=!1}has(t){return void 0!==this._lookup[t]}contains(t){return this.has(t)}get(t){return this._lookup[t]}set(t,e){return this._isDirty=this._isDirty||this.has(t),void 0!==e&&(this._lookup[t]=e,this._isDirty||this._list.push(e)),this}delete(t){return this.has(t)&&(delete this._lookup[t],this._isDirty=!0),this}clear(){return wipe(this._lookup),this._list.clear(),this}get values(){return this.cleanList(),this._list.values}get keys(){return Object.keys(this._lookup)}get list(){return this.cleanList(),this._list}get count(){let t=0;return t=this._isDirty?this.keys.length:this._list.count}cleanList(){this._isDirty&&this.reCreateList()}reCreateList(){let t=this._lookup,e=Object.keys(this._lookup),n=-1,i=this._list;for(i.clear();++n<e.length;)i.add(t[e[n]])}clone(){let t=new Dictionary;return t._isDirty=this._isDirty,t._list=this._list.clone(),t._lookup=clone(this._lookup),t}toJSON(){return this._lookup}revive(t,...e){let[n,...i]=e;if(this.clear(),isNotUndefined(n))if(isNotUndefined(n.prototype.revive))for(let e of Object.keys(t))this.set(e,(new n).revive(t[e],...i));else for(let e of Object.keys(t)){let i=new n;setProperties(i,t[e]),this.set(e,i)}else for(let e of Object.keys(t))this.set(e,t[e]);return this}}class List{constructor(t){this._array=[],this._index=null,this._indexer=null,this._array=void 0===t?new Array:shallowCopy(t instanceof List?t._array:t)}get values(){return this._array}get(t){return this._array[t]}set(t,e){if(!(t>=0&&t<this.length))throw new Error(`index out of bounds on <List>.set(${t}, ${e.toString()})`);return this._array[0|t]=e,null!==this._indexer&&this._index.set(this._indexer(e),e),this}get count(){return this._array.length}get length(){return this._array.length}get indexer(){return this._indexer}set indexer(t){this._indexer=t,this._reindex()}_reindex(){null===this._indexer?this._index=null:(null===this._index?this._index=new Dictionary:this._index.clear(),this.forEach(t=>this._index.set(this._indexer(t),t)))}clear(){return this._array.length=0,null!==this._index&&this._index.clear(),this}add(t){return this._array.push(t),null!==this._indexer&&this._index.set(this._indexer(t),t),this}insertAt(t,e){return insertAt(this._array,t,e),null!==this._indexer&&this._index.set(this._indexer(e),e),this}push(t){return null!==this._indexer&&this._index.set(this._indexer(t),t),this._array.push(t)}pop(){let t=this._array.pop();return void 0!==t&&null!==this._indexer&&this._index.delete(this._indexer(t)),t}shift(){let t=this._array.shift();return void 0!==t&&null!==this._indexer&&this._index.delete(this._indexer(t)),t}concat(t){let e,n=t instanceof List?t.values:t;return e=concat(this._array,n),new List(e)}index(t){null!==this._indexer&&forEach(t,t=>{this._index.set(this._indexer(t),t)})}unindexEl(t){null!==this._indexer&&this._index.delete(this._indexer(t))}append(t){let e=t instanceof List?t.values:t;return append(this._array,e),this.index(e),this}copy(t){let e=t instanceof List?t.values:t;return deepCopyInto(e,this._array),this.index(e),this}shallowCopy(t){let e=t instanceof List?t.values:t;return shallowCopyInto(e,this._array),this.index(e),this}clone(){const t=deepCopy(this._array);let e=new List(t);return null!==this._indexer&&(e._indexer=this._indexer,e._index=this._index.clone()),e}remove(t){return remove(this._array,t),this.unindexEl(t),this}removeFirst(t){let e=this.removeAt(this.indexOf(t));return this.unindexEl(e),e}removeAt(t){let e=removeAt(this._array,t);return this.unindexEl(e),e}forEach(t,e=0){return forEach(this._array,t,e),this}forSome(t,e){return forSome(this._array,t,e),this}until(t,e,n){return until(this._array,t,e,n),this}reverseForEach(t){return reverseForEach(this._array,t),this}reverseUntil(t,e){return reverseUntil(this._array,t,e),this}some(t){return some(this._array,t)}all(t){return all(this._array,t)}indexOf(t){let e=-1;return e=t instanceof Function?indexOf(this._array,t):indexOfElement(this._array,t)}contains(t){let e=!1;return e=null!==this._indexer?this._index.contains(this._indexer(t)):-1!==indexOfElement(this._array,t)}reverse(){return reverse(this._array),this}first(t){let e=-1;return-1===(e=void 0===t?0:indexOf(this._array,t))?void 0:this.get(e)}find(t){return this.first(t)}last(){return 0===this.length?void 0:this.get(this.length-1)}filter(t){return new List(filter(this._array,t))}select(t){return new List(filter(this._array,t))}selectInto(t,e){let n=t instanceof List?t.values:t;return filterInto(n,this._array,e),this.index(n),this}orderBy(t){return this._array.sort(t),this}map(t){return new List(map(this._array,t))}mapInto(t,e){return mapInto(t instanceof List?t.values:t,this._array,e),this._reindex(),this}reduce(t,e){return reduce(this._array,t,e)}reduceUntil(t,e,n){return reduceUntil(this._array,t,e,n)}reverseReduce(t,e){return reverseReduce(this._array,t,e)}reverseReduceUntil(t,e,n){return reverseReduceUntil(this._array,t,e,n)}equals(t){return equals(this._array,t.values)}same(t){let e=this,n=0;return e.length===t.length&&(null!==e.indexer?t.until(t=>!e.contains(t),(t,e)=>++n):e.until(e=>!t.contains(e),(t,e)=>++n)),n===e.length}intersect(t){let e,n,i=new List;return i.indexer=this.indexer,this.length<t.length?(n=this,e=t):(e=this,n=t),null!==e.indexer?n.forEach(t=>{e.contains(t)&&i.push(t)}):e.forEach(t=>{n.contains(t)&&i.push(t)}),i}union(t){let e,n,i=new List;return i.indexer=this.indexer,this.length<t.length?(n=this,e=t):(e=this,n=t),null!==e.indexer?(i=e.clone(),n.forEach(t=>{e.contains(t)||i.push(t)})):(i=n.clone(),e.forEach(t=>{n.contains(t)||i.push(t)})),i}zip(t,e=((t,e)=>[t,e])){let n=new List,i=t.length;return this.until(function(t,e){return e>=i},function(i,s){n.push(e(i,t.get(s)))}),n}unzip(t=(t=>[t[0],t[1]])){let e=[new List,new List];return this.forEach(function(n){let i=t(n);e[0].push(i[0]),e[1].push(i[1])}),e}flatten(t=1/0){return new List(t<1?this.values:this._flattenInner(this.values,t))}_flattenInner(t,e,n=-1,i=[]){let s=-1;const r=t.length;if(++n>e)i.push(t);else for(;++s<r;)isArray(t[s])?this._flattenInner(t[s],e,n,i):t[s]instanceof List?this._flattenInner(t[s].values,e,n,i):i.push(t[s]);return i}toJSON(){return this.values}revive(t,...e){let[n,...i]=e;return isNotUndefined(n)?isNotUndefined(n.prototype.revive)?this.mapInto(t,t=>(new n).revive(t,...i)):this.mapInto(t,t=>{let e=new n;return setProperties(e,t),e}):this.copy(t),this}}class SortedList{constructor(t,e){this._list=new List,this._cmp=t,void 0===e?this._list=new List:e instanceof List||e instanceof SortedList?this.copy(e.values):this.copy(e)}get values(){return this._list.values}get(t){return this._list.get(t)}get count(){return this._list.length}get length(){return this._list.length}get comparer(){return this._cmp}set comparer(t){this._cmp=t,this.sort()}sort(){this._list.orderBy(this._cmp)}clear(){return this._list.clear(),this}add(t){let e=this.getInsertIndex(t);return this._list.insertAt(e,t),this}pop(){return this._list.pop()}shift(){return this._list.shift()}bulkAdd(t){return t instanceof List||t instanceof SortedList?this._list.append(t.values):this._list.append(t),this.sort(),this}copy(t){return t instanceof List||t instanceof SortedList?this._list.copy(t.values):this._list.copy(t),this.sort(),this}clone(){return new SortedList(this._cmp,this._list.clone())}remove(t){let e=this.indexOf(t);return-1!==e&&this._list.removeAt(e),this}removeAt(t){return this._list.removeAt(t)}removeFirst(t){return this._list.removeFirst(t)}forEach(t,e=0){return this._list.forEach(t,e),this}forSome(t,e){return this._list.forSome(t,e),this}until(t,e,n){return this._list.until(t,e,n),this}reverseForEach(t){return this._list.reverseForEach(t),this}reverseUntil(t,e){return this._list.reverseUntil(t,e),this}some(t){return this._list.some(t)}all(t){return this._list.all(t)}getInsertIndex(t){return binarySearch(this._list.values,e=>this._cmp(e,t),!0)}indexOf(t){let e=-1;return e=t instanceof Function?this._list.indexOf(t):binarySearch(this._list.values,e=>this._cmp(e,t),!1)}contains(t){return-1!==this.indexOf(t)}first(t){return this._list.first(t)}find(t){return this._list.find(t)}last(){return this._list.last()}filter(t){return new SortedList(this._cmp,this._list.filter(t))}select(t){return new SortedList(this._cmp,this._list.filter(t))}selectInto(t,e){return t instanceof List||t instanceof SortedList?this._list.selectInto(t.values,e):this._list.selectInto(t,e),this.sort(),this}map(t){return this._list.map(t)}mapInto(t,e){return t instanceof List||t instanceof SortedList?this._list.mapInto(t.values,e):this._list.mapInto(t,e),this.sort(),this}reduce(t,e){return this._list.reduce(t,e)}reduceUntil(t,e,n){return this._list.reduceUntil(t,e,n)}reverseReduce(t,e){return this._list.reverseReduce(t,e)}reverseReduceUntil(t,e,n){return this._list.reverseReduceUntil(t,e,n)}equals(t){return equals(this._list.values,t.values)}same(t){return this.equals(t)}intersect(t){let e,n,i=new SortedList(this.comparer);if(this.length>0&&t.length>0)if(this.length<t.length?(n=this,e=t):(e=this,n=t),t instanceof SortedList&&this.comparer===t.comparer){let t=e.getInsertIndex(n.get(0))-1,s=e.getInsertIndex(n.last())-1,r=-1,o=n.length;for(;t<s&&++r<o;){let o,l=n.get(r);for(;++t<s&&(o=this.comparer(e.get(t),l))<0;);t<s&&0===o&&i.add(l)}}else e instanceof SortedList||e instanceof List&&null!==e.indexer?n.forEach(t=>{e.contains(t)&&i.add(t)}):i=i.bulkAdd(n.toList().intersect(e));return i}union(t){let e,n,i;if(this.length>0||t.length>0)if(this.length<t.length?(i=this,n=t):(n=this,i=t),t instanceof SortedList&&this.comparer===t.comparer){e=new SortedList(this.comparer,n.values);let t=n.getInsertIndex(i.get(0))-1,s=n.getInsertIndex(i.last())-1,r=-1,o=i.length;for(;++r<o&&t<s;){let o=i.get(r),l=-1;for(;++t<s&&(l=this.comparer(n.get(t),o))<0;);(l>0&&t<s||t===s)&&e.add(o)}if(r<o)for(--r;++r<o;)e.add(i.get(r))}else n instanceof SortedList||n instanceof List&&null!==n.indexer?(e=new SortedList(this.comparer,n.values),i.forEach(t=>{n.contains(t)||e.add(t)})):e=new SortedList(this.comparer,i.toList().union(n));else e=new SortedList(this.comparer);return e}toList(){return new List(this.values)}toJSON(){return this.values}revive(t,...e){let[n,...i]=e;return isNotUndefined(n)?isNotUndefined(n.prototype.revive)?this.mapInto(t,t=>(new n).revive(t,...i)):this.mapInto(t,t=>{let e=new n;return setProperties(e,t),e}):this.copy(t),this}}class Stack{constructor(t){this.DEFAULT_SIZE=100,this._pos=0,this._limit=0,t||(t=this.DEFAULT_SIZE),this.DEFAULT_SIZE=t,this._array=new Array(t),this.push=this.fastPush}get values(){return slice(this._array,0,this._pos)}get depth(){return this._pos}get size(){return this._pos}get isEmpty(){return 0===this.size}get limit(){return this._limit}set limit(t){t<0&&(t=0),this._limit=t,0===t?this.push=this.fastPush:(this.push=this.limitedPush,this.limitObjects())}push(t){}fastPush(t){this._array[this._pos++]=t}limitedPush(t){this._array[this._pos]=t,++this._pos,this.limitObjects()}pop(){let t=void 0;return 0!==this._pos&&(t=this._array[--this._pos]),t}peek(){return this._array[this._pos-1]}peekAt(t){return t<0||t>=this._pos?void 0:this._array[this._pos-t-1]}toList(){new List;return new List(this.values)}clear(){return this._pos=0,this._array.length=this.DEFAULT_SIZE,this}limitObjects(){if(this._limit>0)for(;this._pos>this._limit;)this._array.shift(),--this._pos}toJSON(){return this.values}}class TimerState{}TimerState._hasPerformance="undefined"!=typeof performance;class Timer{static get time(){return TimerState._time}constructor(){Timer.start()}static now(){if(TimerState._hasPerformance)return performance.now();{const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}}static start(){const t=Timer.now();return TimerState._start=TimerState._last=t,TimerState._time=0}static stop(){const t=TimerState._start,e=Timer.now();return TimerState._last=e,TimerState._time=e-t}}class UtilState{}UtilState._int=0;var Util=Object.freeze({init:init,getFunctionName:getFunctionName,getFunctionCode:getFunctionCode,newUUID:newUUID,newInt:newInt,callDebugger:callDebugger,pipeOut:pipeOut,assert:assert,proxyFn:proxyFn,loop:loop,toArray:toArray});class Tree{constructor(){this.id="",this.parent=null,this.children=null,this.data=null,this.id=newUUID()}static fromObject(t){const e=this instanceof Tree?this:null,n=(new Tree).init({id:t.id||newUUID(),data:t.data,parent:e});return void 0!==t.children&&isArray(t.children)&&(n.children=new List(map(t.children,Tree.fromObject.bind(n)))),n}static fromNodeList(t,e){let n=new Tree,i=t=>e&&void 0!==e[t]?"string"==typeof e[t]?n=>n[e[t]]:e[t]:e=>e[t],s={id:i("id"),parent:i("parent"),data:i("data")},r=new List(t),o=new Dictionary;for(r.forEach((t,e)=>{let n=(new Tree).init({id:s.id(t),data:s.data(t)});o.set(n.id,n)}),r.forEach((t,e)=>{let n=s.parent(t);o.contains(n)&&o.get(n).add(o.get(s.id(t)))}),n=o.get(s.id(r.get(0)));n.parent;)n=n.parent;return n}init(t){return setProperties(this,t),this}insertAt(t,e){null===this.children||this.children.count<=t?this.add(e):this.children.insertAt(t,(new Tree).init({data:e,parent:this}))}add(t){null===this.children&&(this.children=new List),isSameClass(t,this)?(t.parent=this,this.children.add(t)):this.children.add((new Tree).init({data:t,parent:this}))}remove(){null!==this.parent&&this.parent.children.remove(this)}prune(){return null!==this.children&&this.children.forEach(function(t,e){t.parent=null}).clear(),this.children=null,this}reduce(t,e){const n=new Stack;let i=e;t||(t=((t,e)=>(t.push({id:e.id,parent:e.parent?e.parent.id:null,data:e.data}),t))),void 0===e&&(i=[]);let s,r;for(n.push(this);s=n.pop();)for(i=t(i,s),r=s.children&&s.children.count||0;r--;)n.push(s.children.get(r));return i}clone(){const t=new this.constructor;return t.id=this.id,t.parent=this.parent,t.children=null===this.children?null:this.children.clone(),t.data=null===this.data||void 0===this.data?this.data:clone(this.data),t}duplicateNode(){const t=new this.constructor;return t.id=this.id,t.parent=this.parent,t.children=this.children,t.data=this.data,t}filter(t){const e=this.duplicateNode();return null!==this.children&&(e.children=e.children.select(t).map(function(e,n){return e.filter(t)})),e}select(t,e=new List){const n=e,i=this.children;return(void 0===t||t(this))&&n.add(this),i&&i.reduce(function(e,n){return n.select(t,e)},n),n}find(t){let e=null;if(null!==this.children){let n=-1;const i=this.children.count,s=this.children.values;for(;++n<i;){if(t(s[n].data)){e=s[n];break}if(null!==(e=null!==s[n].children?s[n].find(t):null))break}}return e}contains(t){return null!==this.find(t)}depth(){let t=0,e=this;for(;e.parent;)e=e.parent,++t;return t}toJSON(){let t=new List;return t.push({id:this.id,data:this.data,parent:null===this.parent?null:this.parent.id,children:null===this.children?null:this.children.map(t=>t.id)}),null!==this.children&&this.children.forEach(e=>t.append(e.toJSON())),t.toJSON()}}var Sides;!function(t){t[t.Top=0]="Top",t[t.Bottom=1]="Bottom",t[t.Left=2]="Left",t[t.Right=3]="Right"}(Sides||(Sides={}));class DomState{}DomState.Sides=Sides,DomState._window=Global.window,DomState._document=Global.window?Global.window.document:void 0,DomState._el=Global.window?Global.window.document.createElement("div"):void 0;var Dom=Object.freeze({get Sides(){return Sides},init:init$1,toArray:toArray$1,create:create$1,outerHTML:outerHTML,setAttr:setAttr,remove:remove$1,replace:replace,clear:clear,get:get,find:find,findAll:findAll,children:children,findParent:findParent,position:position,is:is,setStylesExplicitly:setStylesExplicitly});class Uri{constructor(){this._a=null,this.hash="",this.pathName="",this.port="",this.hostName="",this.protocol="",this.origin="",this.full="",this.args={},this.init()}init(){if(null!==Global.window){this._a=Global.window.document.createElement("a"),this._a.setAttribute("href",Global.window.location.href);const t=this.args;this._a.search.substring(1).split("&").forEach(e=>{const n=e.split("=");t[n[0]]=n[1]}),this.hash=this._a.hash,this.pathName=this._a.pathname,this.port=this._a.port,this.hostName=this._a.hostname,this.protocol=this._a.protocol,this.origin=this._a.origin,this.full=this._a.href}}}let async=function(t,e,n){const i=n.value;return n.value=function(...t){return new Promise((e,n)=>{let s;try{e(s=i.apply(this,t))}catch(t){n(t)}})},n};async.before=function(t){return function(e,n,i){const s=i.value;return i.value=function(...e){return new Promise((n,i)=>{const r=()=>{s.apply(this,e).then(t=>{n(t)}).catch(t=>{i(t)})};t.apply(this,[s.name].concat(e)).then(t=>{r()}).catch(t=>{r()})})},i}},async.after=function(t){return function(e,n,i){const s=i.value;return i.value=function(...e){return new Promise((n,i)=>{const r=(r,o)=>{t.apply(this,[r,o,s.name].concat(e)).then(t=>{n(t)}).catch(t=>{i(t)})};s.apply(this,e).then(t=>{r(t,void 0)}).catch(t=>{r(void 0,t)})})},i}},async.provided=function(t){return function(e,n,i){const s=i.value;return i.value=function(...e){return new Promise((n,i)=>{t.apply(this,[s.name].concat(e)).then(t=>{t?(()=>{s.apply(this,e).then(t=>{n(t)}).catch(t=>{i(t)})})():i(!1)}).catch(t=>{i(t)})})},i}};class Pool{constructor(t,e=10){this._pool=[],this._available=0,this._size=0,this._cls=t,this._growthStep=e,this.create()}get available(){return this._available}get size(){return this._size}create(){let t=0;for(;t<this._growthStep;t++)this._pool.push(new this._cls);this._size+=this._growthStep,this._available+=this._growthStep}get(){let t;return 0===this._pool.length&&this.create(),t=this._pool.pop(),--this._available,t.initPool(this),t}release(t){this._pool.push(t),++this._available}}var MocDataType;!function(t){t[t.LinearInt=0]="LinearInt",t[t.RandomInt=1]="RandomInt",t[t.LinearFloat=2]="LinearFloat",t[t.RandomFloat=3]="RandomFloat"}(MocDataType||(MocDataType={}));const VALID_CHARS=" ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";var MocData=Object.freeze({get MocDataType(){return MocDataType},VALID_CHARS:VALID_CHARS,randomString:randomString,randomInt:randomInt,randomNumber:randomNumber,numericArray:numericArray,stringArray:stringArray});class KeyValuePair{}export{Calc,Dom,Arr,Obj,Util,Test,MocData,Vec2,Vec2Const,Range2,Rect,List,SortedList,Dictionary,Stack,Tree,Timer,Uri,Poolable,Initable,before,after,around,provided,async,Pool,integrate,KeyValuePair};
//# sourceMappingURL=goodcore.es6.min.js.map
